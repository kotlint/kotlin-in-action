# μ λ„¤λ¦­μ¤

---

### 9μ¥μ—μ„ λ°°μ°λ” λ‚΄μ©

- μ λ„¤λ¦­ ν•¨μμ™€ ν΄λμ¤λ¥Ό μ •μν•λ” λ°©λ²•
- νƒ€μ… μ†κ±°μ™€ μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°
- μ„ μ–Έ μ§€μ κ³Ό μ‚¬μ© μ§€μ  λ³€μ„±

---

### 9.1 μ λ„¤λ¦­ νƒ€μ… νλΌλ―Έν„°

μ λ„¤λ¦­μ¤λ¥Ό μ‚¬μ©ν•λ©΄ λ°›λ” νƒ€μ…μ„ μ •μν•  μ μμ.

μ λ„¤λ¦­ νƒ€μ…μ μΈμ¤ν„΄μ¤λ¥Ό λ§λ“λ ¤λ©΄ νƒ€μ… νλΌλ―Έν„°λ¥Ό κµ¬μ²΄μ μΈ `νƒ€μ… μΈμ`λ΅ μΉν™ν•΄μ•Όν•¨.

```kotlin
List<String>
```

νƒ€μ…μ„ μΈμ¤ν„΄μ¤ν™” ν•λ” λ°©λ²•

```kotlin
Map<K, V>λ¥Ό Map<String, Person>μ²λΌ κµ¬μ²΄μ μΈ νƒ€μ…μ„ νƒ€μ… μΈμλ΅ λ„κΈ°λ©΄ λ¨
```

μ½”ν‹€λ¦° μ»΄νμΌλ¬λ” νƒ€μ…μΈμλ„ μ¶”λ΅  κ°€λ¥ν•λ‹¤

μλ°”μ™€ λ‹¬λ¦¬ μ½”ν‹€λ¦°μ€ μ λ„¤λ¦­ νƒ€μ…μ **νƒ€μ… μΈμλ¥Ό ν”„λ΅κ·Έλλ¨Έκ°€ λ…μ‹ν•κ±°λ‚ μ»΄νμΌλ¬κ°€ μ¶”λ΅ ν•  μ μμ–΄μ•Όν•λ‹¤**. μ΄μ λ” μλ°”λ” λ§¨μ²μμ— μ λ„¤λ¦­ μ§€μ›μ΄ μ—†μ—κ³  μλ°” 1.5μ—μ„ λ’¤λ¦κ² μƒκ²¨ μ΄μ „λ²„μ „κ³Ό νΈν™μ„±μ„ μ μ§€ν•κΈ° μ„ν•΄ νƒ€μ… μΈμκ°€ μ—†λ” μ λ„¤λ¦­ νƒ€μ…(`raw νƒ€μ…`)μ„ ν—μ©ν•λ‹¤. κ·Έλ¬λ‚ μ½”ν‹€λ¦°μ€ μ²μλ¶€ν„° μ λ„¤λ¦­μ„ λ„μ…ν–κΈ°λ•λ¬Έμ— `rawνƒ€μ…`μ„ μ§€μ›ν•μ§€ μ•κ³  μ λ„¤λ¦­ νƒ€μ…μ νƒ€μ…μΈμλ¥Ό ν•­μƒ μ •μν•΄μ•Ό ν•λ‹¤.

```kotlin
int list = new List<>() //μλ°”λ” κ°€λ¥ν•μ§€λ§ μ½”ν‹€λ¦°μ€ μ•λ¨
var list = List<String>() //ν•­μƒ νƒ€μ… μΈμλ¥Ό μ •μν•΄μ•Όν•¨
```

---

### 9.1.1 μ λ„¤λ¦­ ν•¨μμ™€ ν”„λ΅νΌν‹°

μ λ„¤λ¦­ ν•¨μλ¥Ό νΈμ¶ν•  λ•λ” λ°λ“μ‹ κµ¬μ²΄μ  νƒ€μ…μΌλ΅ νƒ€μ… μΈμλ¥Ό λ„κ²¨μ•Ό ν•λ‹¤.

```kotlin
fun <T> List<T>.slice(indices: IntRange): List<T>
    (1)     (2)                               (3)
(1) : νƒ€μ… νλΌλ―Έν„° μ„ μ–Έ
(2), (3) : νƒ€μ… νλΌλ―Έν„°κ°€ μμ‹  κ°μ²΄μ™€ λ°ν™ νƒ€μ…μ— μ“°μ„
```

μ΄λ° ν•¨μλ¥Ό κµ¬μ²΄μ μΈ λ¦¬μ¤νΈμ— λ€ν•΄ νΈμ¶ν•  λ• νƒ€μ… μΈμλ¥Ό λ…μ‹μ μΌλ΅ μ§€μ •ν•  μ μλ‹¤.

ν•μ§€λ§ μ‹¤μ λ΅λ” λ€λ¶€λ¶„ μ»΄νμΌλ¬κ°€ νƒ€μ… μΈμλ¥Ό μ¶”λ΅ ν•  μ μμΌλ―€λ΅ κ·Έλ΄ν•„μ”κ°€ μ—†λ‹¤.

```kotlin
val letters = ('a'..'z').toList()
println(letters.slice<Char>(0..2))
>>>[a,b,c]

println(letters.slice(0..2))
>>>[a,b,c]
```

- μ λ„¤λ¦­ κ³ μ°¨ ν•¨μ νΈμ¶ν•κΈ°

```kotlin
val authors = listOf("Dmitry", "Svetlana")
val readers = mutableListOf<String>()

fun <T> List<T>.filter(predicate: (T) -> Boolean): List<T> -> filterν•¨μ μ •μ
>>>readers.filter{ it !in authors)

itμ νƒ€μ…μ€ TλΌλ” μ λ„¤λ¦­ νƒ€μ…
μ»΄νμΌλ¬λ” filterκ°€ List<T>νƒ€μ…μ λ¦¬μ¤νΈμ— μν•΄μ„ νΈμ¶λ  μ μλ‹¤λ” μ‚¬μ‹¤κ³Ό filter κ°μ²΄μ
readersμ νƒ€μ…μ΄ List<String>μ΄λΌλ” μ‚¬μ‹¤μ„ μ•κ³  Tκ°€ Stringμ΄λΌλ” μ‚¬μ‹¤μ„ μ¶”λ΅ ν•λ‹¤.
```

- μ λ„¤λ¦­ ν™•μ¥ ν”„λ΅νΌν‹° μ„ μ–Έ

```kotlin
val <T> List<T>.penultimate: T (1)
	get() = this[size - 2]
println(listOf(1, 2, 3, 4).penultimate) (2)
>>> 3

(1) : λ¨λ“  λ¦¬μ¤νΈ νƒ€μ…μ— λ€ν•΄ μ΄ μ λ„¤λ¦­ ν™•μ¥ ν”„λ΅νΌν‹°λ¥Ό μ‚¬μ©ν•  μ μλ‹¤.
(2) : μ΄ νΈμ¶μ—μ„ νƒ€μ… νλΌλ―Έν„° Tλ” Intλ΅ μ¶”λ΅ λ¨
```

**ν™•μ¥ ν”„λ΅νΌν‹°λ§ μ λ„¤λ¦­ν•κ² λ§λ“¤ μ μλ‹¤**.

- μΌλ° ν”„λ΅νΌν‹°λ” νƒ€μ… νλΌλ―Έν„°λ¥Ό κ°€μ§ μ μ—†λ‹¤. ν΄λμ¤ ν”„λ΅νΌν‹°μ— μ—¬λ¬ νƒ€μ…μ κ°’μ„ μ €μ¥ν•  μλ” μ—†μΌλ―€λ΅ μ λ„¤λ¦­ν• μΌλ° ν”„λ΅νΌν‹°λ” λ§μ΄ λμ§€ μ•λ”λ‹¤. μΌλ° ν”„λ΅νΌν‹°λ¥Ό μ λ„¤λ¦­ν•κ² μ •μν•λ©΄ μ»΄νμΌλ¬κ°€ λ‹¤μκ³Ό κ°™μ€ μ¤λ¥λ¥Ό ν‘μ‹ν•λ‹¤.

```kotlin
val <T> x: T = TODO()
>>> ERROR: type parameter of a property must be used in its receiver type
```

---

### 9.1.2 μ λ„¤λ¦­ ν΄λμ¤ μ„ μ–Έ

μ½”ν‹€λ¦°μ—μ„ νƒ€μ… νλΌλ―Έν„°λ¥Ό λ„£μ€ `<>`λ¥Ό ν΄λμ¤ μ΄λ¦„ λ’¤μ— λ¶™νλ©΄ ν΄λμ¤λ¥Ό μ λ„¤λ¦­ν•κ² λ§λ“¤ μ μλ‹¤. νƒ€μ… νλΌλ―Έν„°λ¥Ό μ΄λ¦„ λ’¤μ— λ¶™νκ³  λ‚λ©΄ ν΄λμ¤ λ³Έλ¬Έ μ•μ—μ„ νƒ€μ… νλΌλ―Έν„°λ¥Ό λ‹¤λ¥Έ μΌλ° νƒ€μ…μ²λΌ μ‚¬μ©ν•  μ μλ‹¤.

```kotlin
interface List<T> { (1)
	operator fun get(index: Int): T (2)
}
(1) : List μΈν„°νμ΄μ¤μ— TλΌλ” νƒ€μ… νλΌλ―Έν„°λ¥Ό μ •μν•λ‹¤
(2) : μΈν„°νμ΄μ¤ μ•μ—μ„ Tλ¥Ό μΌλ° νƒ€μ…μ²λΌ μ‚¬μ©ν•  μ μλ‹¤
```

μ λ„¤λ¦­ ν΄λμ¤λ¥Ό ν™•μ¥ν•λ” ν΄λμ¤λ¥Ό μ •μν•λ ¤λ©΄ κΈ°λ° νƒ€μ…μ μ λ„¤λ¦­ νλΌλ―Έν„°μ— λ€ν•΄ νƒ€μ… μΈμλ¥Ό μ§€μ •ν•΄μ•Ό ν•λ‹¤. μ΄λ• κµ¬μ²΄μ μΈ νƒ€μ…μ„ λ„κΈΈ μλ„ μκ³  νƒ€μ… νλΌλ―Έν„°λ΅ λ°›μ€ νƒ€μ…μ„ λ„κΈΈ μλ„ μλ‹¤.

```kotlin
class StringList: List<String>{ (1)
	override fun get(index: Int): String = ... 
}

class ArrayList<T>: List<T>{ (2)
	override fun get(index: Int): T = ...
}
(1) : μ΄ ν΄λμ¤λ” κµ¬μ²΄μ μΈ νƒ€μ… μΈμλ΅ Stringμ„ μ§€μ •ν•΄ Listλ¥Ό κµ¬ν„ν•λ‹¤.
(2) : ArrayListμ μ λ„¤λ¦­ νƒ€μ… νλΌλ―Έν„° Tλ¥Ό Listμ νƒ€μ… μΈμλ΅ λ„κΈ΄λ‹¤.
```

- `StringList`ν΄λμ¤λ” Stringνƒ€μ…μ μ›μ†λ§μ„ ν¬ν•¨ν•λ‹¤. λ”°λΌμ„ Stringμ„ κΈ°λ° νƒ€μ…μ νƒ€μ… μΈμλ΅ μ§€μ •ν•λ‹¤. ν•μ„ ν΄λμ¤μ—μ„ μƒμ„ ν΄λμ¤μ— μ •μλ ν•¨μλ¥Ό μ¤λ²„λΌμ΄λ“ν•κ±°λ‚ μ‚¬μ©ν•λ ¤λ©΄ νƒ€μ… μΈμ `T`λ¥Ό κµ¬μ²΄μ  νƒ€μ… StringμΌλ΅ μΉν™ν•΄μ•Ό ν•λ‹¤. λ”°λΌμ„ `StringList`μ—μ„λ” `fun get(int): T`κ°€ μ•„λ‹λΌ `fun get(Int): String`μ΄λΌκ³  ν•΄μ•Όν•¨
- ArrayListν΄λμ¤λ” μμ‹ λ§μ νƒ€μ… `T`λ¥Ό μ •μν•λ©΄μ„ κ·Έ `T`λ¥Ό κΈ°λ° ν΄λμ¤μ νƒ€μ… μΈμλ΅ μ‚¬μ©ν•λ‹¤. μ—¬κΈ°μ„ ArrayList<T>μ™€ List<T>μ `T`λ” κ°™μ§€ μ•λ‹¤. ArrayList<T>μ `T`λ” μ•μ—μ„ λ³Έ List<T>μ™€ μ „ν€ λ‹¤λ¥Έ νƒ€μ… νλΌλ―Έν„°λ©°, μ‹¤μ λ΅λ” `T`κ°€ μ•„λ‹λΌ λ‹¤λ¥Έ μ΄λ¦„μ„ μ‚¬μ©ν•΄λ„ μλ―Έμ—λ” μ•„λ¬΄ μ°¨μ΄κ°€ μ—†λ‹¤.

```kotlin
class ArrayList<K>: List<K>{
    override fun get(index: Int): K = ...
}
```

ν΄λμ¤κ°€ μκΈ° μμ‹ μ„ νƒ€μ… μΈμλ΅ μ°Έμ΅°ν•  μλ„ μλ‹¤. Comparable μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•λ” ν΄λμ¤κ°€ μ΄λ° ν¨ν„΄μ μλ‹¤. λΉ„κµ κ°€λ¥ν• λ¨λ“  κ°’μ€ μμ‹ μ„ κ°™μ€ νƒ€μ…μ λ‹¤λ¥Έ κ°’κ³Ό λΉ„κµν•λ” λ°©λ²•μ„ μ κ³µν•΄μ•Όλ§ ν•λ‹¤.

```kotlin
interface Comparable<T>{
	fun compareTo(other: T): Int
}

class String: Comparable<String>{
	override fun compareTo(other: String): Int = ...
}
```

---

### 9.1.3 νƒ€μ… νλΌλ―Έν„° μ μ•½

ν΄λμ¤λ‚ ν•¨μμ— μ‚¬μ©ν•  μ μλ” νƒ€μ… μΈμλ¥Ό μ ν•ν•λ” κΈ°λ¥

μ–΄λ–¤ νƒ€μ…μ„ μ λ„¤λ¦­ νƒ€μ…μ νƒ€μ… νλΌλ―Έν„°μ— λ€ν• `μƒν•`μΌλ΅ μ§€μ •ν•λ©΄ κ·Έ μ λ„¤λ¦­ νƒ€μ…μ„ μΈμ¤ν„΄μ¤ν™”ν• λ• μ‚¬μ©ν•λ” νƒ€μ… μΈμλ” λ°λ“μ‹ κ·Έ μƒν•νƒ€μ…μ΄κ±°λ‚ κ·Έ μƒν• νƒ€μ…μ ν•μ„ νƒ€μ…μ΄μ–΄μ•Ό ν•λ‹¤.

μ μ•½μ„ κ°€ν•λ ¤λ©΄ νƒ€μ… νλΌλ―Έν„° μ΄λ¦„ λ’¤μ— μ½λ΅ (:)μ„ ν‘μ‹ν•κ³  κ·Έ λ’¤μ— μƒν• νƒ€μ…μ„ μ μΌλ©΄ λλ‹¤.

```kotlin
fun <T : Number> List<T>.sum(): T
	  (1)    (2)
(1) : νƒ€μ… νλΌλ―Έν„°
(2) : μƒν•
```

- νƒ€μ… νλΌλ―Έν„° `T`μ— λ€ν• μƒν•μ„ μ •ν•κ³  λ‚λ©΄ `T`νƒ€μ…μ κ°’μ„ κ·Έ μƒν• νƒ€μ…μ κ°’μΌλ΅ μ·¨κΈ‰ν•  μ μλ‹¤. μλ¥Ό λ“¤λ©΄ μƒν• νƒ€μ…μ— μ •μλ λ©”μ„λ“λ¥Ό `T`νƒ€μ… κ°’μ— λ€ν•΄ νΈμ¶ν•  μ μλ‹¤.

```kotlin
fun <T : Number> oneHalf(value: T): Double{ (1)
	return value.toDouble() / 2.0 (2)

println(oneHalf(3))
>>> 1.5

(1) : Numberλ¥Ό νƒ€μ… νλΌλ―Έν„° μƒν•μΌλ΅ μ •ν•λ‹¤
(2) : Number ν΄λμ¤μ— μ •μλ λ©”μ„λ“(toDouble())λ¥Ό νΈμ¶ν•λ‹¤
```

- λ‘ νλΌλ―Έν„° μ‚¬μ΄μ—μ„ ν° κ°’μ„ μ°Ύλ” μ λ„¤λ¦­ ν•¨μ

```kotlin
fun <T : Comparable<T> max(first: T, second: T): T {
	return if(first > second) first else second
}

println(max("kotlin", "java"))
>>> kotlin
```

- μ•„μ£Ό λ“λ¬Όμ§€λ§ νƒ€μ… νλΌλ―Έν„°μ— λ€ν•΄ λ‘ μ΄μƒμ μ μ•½μ„ κ°€ν•΄μ•Ό ν•λ” κ²½μ°λ„ μλ‹¤. μ΄λ΄λ•λ” μ•½κ°„ λ‹¤λ¥Έ κµ¬λ¬Έμ„ μ‚¬μ©ν•λ‹¤.

```kotlin
fun <T> ensureTrailingPeriod(seq: T) where T : CharSequence, T : Appendable { (1)
	if(!seq.endWith('.')){ (2)
		seq.append('.') (3)
	}
}

val helloworld = StringBuilder("Hello World")
ensureTrailingPeriod(helloworld)
println(helloworld)
>>> Hello World.

(1) : νƒ€μ… νλΌλ―Έν„° μ μ•½ λ©λ΅
(2) : CharSequence μΈν„°νμ΄μ¤μ ν™•μ¥ ν•¨μλ¥Ό νΈμ¶ν•λ‹¤.
(3) : Appendable μΈν„°νμ΄μ¤μ λ©”μ„λ“λ¥Ό νΈμ¶ν•λ‹¤
```

---

### 9.1.4 νƒ€μ… νλΌλ―Έν„°λ¥Ό λ„μ΄ λ  μ μ—†λ” νƒ€μ…μΌλ΅ ν•μ •

μ λ„¤λ¦­ ν΄λμ¤λ‚ ν•¨μλ¥Ό μ •μν•κ³  κ·Έ νƒ€μ…μ„ μΈμ¤ν„΄μ¤ν™” ν• λ•λ” λ„μ΄ λ  μ μλ” νƒ€μ…μ„ ν¬ν•¨ν•λ” μ–΄λ–¤ νƒ€μ…μΌλ΅ νƒ€μ… μΈμλ¥Ό μ§€μ •ν•΄λ„ νƒ€μ… νλΌλ―Έν„°λ¥Ό μΉν™ν•  μ μλ‹¤. μ•„λ¬΄λ° μƒν•μ„ μ •ν•μ§€ μ•μ€ νƒ€μ… νλΌλ―Έν„°λ” κ²°κ³Όμ μΌλ΅ `Any?`λ¥Ό μƒν•μΌλ΅ μ •ν• νλΌλ―Έν„°μ™€ κ°™λ‹¤.

```kotlin
class Processor<T>{
	fun process(value: T){
		value?.hashCode() -> valueλ” nullμ΄ λ  μ μμΌλ―€λ΅ μ•μ „ν• νΈμ¶μ„ μ‚¬μ©ν•΄μ•Ό ν•¨
	}
}
```

- ν•­μƒ λ„μ΄ λ  μ **μ—†λ”** νƒ€μ…λ§ νƒ€μ… μΈμλ΅ λ°›κ²ν•λ” λ°©λ²•

```kotlin
class Processor<T: Any>{ (1)
	fun process(value: T){
		value.hashCode() (2)
	}
}
(1) : nullμ΄ λ  μ μ—†λ” νƒ€μ… μƒν•μ„ μ§€μ •
(2) : T νƒ€μ…μ valueλ” nullμ΄ λ  μ μ—†λ‹¤
```

---

### 9.2 μ‹¤ν–‰ μ‹ μ λ„¤λ¦­μ¤ λ™μ‘ : μ†κ±°λ νƒ€μ… νλΌλ―Έν„°μ™€ μ‹¤μ²΄ν™”λ νƒ€μ… νλΌλ―Έν„°

JVMμ—μ„μ μ λ„¤λ¦­μ¤λ” λ³΄ν†µ νƒ€μ… μ†κ±°λ¥Ό μ‚¬μ©ν•΄ κµ¬ν„λλ‹¤. μ΄λ” μ‹¤ν–‰ μ‹μ μ— μ λ„¤λ¦­ ν΄λμ¤μ μΈμ¤ν„΄μ¤μ— νƒ€μ… μΈμ μ •λ³΄κ°€ λ“¤μ–΄μμ§€ μ•λ‹¤λ” λ»μ΄λ‹¤.

μ½”ν‹€λ¦°μ—μ„λ” νƒ€μ… μ†κ±°λ¥Ό ν•μ§€ μ•κΈ° μ„ν•΄ ν•¨μλ¥Ό inlineμΌλ΅ μ„ μ–Έν•¨μΌλ΅μ¨ νƒ€μ… μ†κ±°λ¥Ό μ°νν•λ” κ²ƒμ„ μ‹¤μ²΄ν™” λΌκ³ ν•λ‹¤.

---

### 9.2.1 μ‹¤ν–‰ μ‹μ μ μ λ„¤λ¦­ : νƒ€μ… κ²€μ‚¬μ™€ μΊμ¤νΈ

μ½”ν‹€λ¦° μ λ„¤λ¦­ νƒ€μ… μΈμ μ •λ³΄λ” μ‹¤ν–‰μ‹μ μ— μ§€μ›μ§„λ‹¤. μ΄λ” μ λ„¤λ¦­ ν΄λμ¤ μΈμ¤ν„΄μ¤κ°€ κ·Έ μΈμ¤ν„΄μ¤λ¥Ό μƒμ„±ν•  λ• μ“°μΈ νƒ€μ… μΈμμ— λ€ν• μ •λ³΄λ¥Ό μ μ§€ν•μ§€ μ•λ”λ‹¤λ” λ»μ΄λ‹¤.

```kotlin
val list1: List<String> = listOf("a","b")
val list2: List<Int> = listOf(1,2,3)

μ‹¤ν–‰ μ‹μ μ— list1μ΄λ‚ list2κ°€ λ¬Έμμ—΄μ΄λ‚ μ •μν• λ¦¬μ¤νΈλ΅ μ„ μ–Έλ¬λ‹¤λ” μ‚¬μ‹¤μ„ μ• μ μ—†λ‹¤.
κ° κ°μ²΄λ” listμΌ λΏμ΄λ‹¤.

μ°λ¦¬κ°€ list1μ—λ” λ¬Έμμ—΄λ§, list2μ—λ” μ •μν•λ§ λ“¤μ–΄μλ‹¤κ³  κ°€μ •ν•  μ μλ” μ΄μ λ” μ»΄νμΌλ¬κ°€ 
νƒ€μ… μΈμλ¥Ό μ•κ³  μ¬λ°”λ¥Έ νƒ€μ…μ κ°’λ§ κ° λ¦¬μ¤νΈμ— λ„£λ„λ΅ λ³΄μ¥ν•κΈ° λ•λ¬Έμ΄λ‹¤.
```

νƒ€μ… μ†κ±°λ΅ μΈν• ν•κ³„μ  : μ‹¤ν–‰ μ‹μ μ— νƒ€μ… μΈμλ¥Ό κ²€μ‚¬ν•  μ μ—†λ‹¤.

```kotlin
if(value is List<String>){...}
>>> ERROR: Cannot check for instance of erased type
```

μ½”ν‹€λ¦°μ—μ„λ” νƒ€μ… μΈμλ¥Ό λ…μ‹ν•μ§€ μ•κ³  μ λ„¤λ¦­ νƒ€μ…μ„ μ‚¬μ©ν•  μ μ—†λ‹¤. μ΄λ• μ–΄λ–¤ κ°’μ΄ λ§µμ΄ μ•„λ‹λΌ λ¦¬μ¤νΈλΌλ” μ‚¬μ‹¤μ„ μ–΄λ–»κ² ν™•μΈν•  μ μλ” λ°©λ²•μ€ μ¤νƒ€ ν”„λ΅μ μ…μ„ μ‚¬μ©ν•λ©΄ λλ‹¤.

```kotlin
if(value is List<*>){...}

νƒ€μ… νλΌλ―Έν„°κ°€ 2κ° μ΄μƒμ΄λΌλ©΄ λ¨λ“  νλΌλ―Έν„°μ— * μ„ ν¬ν•©ν•΄μ•Ό ν•λ‹¤.
```

is μ²λΌ asλ‚ as? μΊμ¤ν…μ—λ„ μ λ„¤λ¦­ νƒ€μ…μ„ μ‚¬μ©ν•  μ μλ‹¤. 

**ν•μ§€λ§ μ‹¤ν–‰ μ‹μ μ—λ” μ λ„¤λ¦­ νƒ€μ…μ νƒ€μ… μΈμλ¥Ό μ• μ μ—†μΌλ―€λ΅ μΊμ¤ν…μ€ ν•­μƒ μ„±κ³µν•λ‹¤**.

```kotlin
fun printSum(c: Collection<*>){
	val intList = c as? List<Int> (1)
		?: throw IllegalArgumentException("List is expected")
	println(intList.sum())
}
println(listOf(1,2,3)) (2)
>>> 6

(1) : Unchecked cast: List<*> to List<Int> κ²½κ³  λ°μƒ, νƒ€μ…μΈμλ¥Ό μ• μ μ—†κΈ° λ•λ¬Έ
(2) : κ²½κ³ λ” λ°μƒν•μ§€λ§ μμƒλ€λ΅ μ‘λ™ν•¨

*λ§μ•½ μ •μ λ¦¬μ¤νΈκ°€ μ•„λ‹ μ •μ μ§‘ν•©μ„ λ„£λ” κ²½μ° μ—λ” IllegalArgumentExceptionμ΄ λ°μƒν•λ‹¤.
*μλ»λ νƒ€μ…μ μ›μ†κ°€ λ“¤μ–΄μλ” λ¦¬μ¤νΈλ¥Ό μ „λ‹¬ν•λ‹¤λ©΄ μ‹¤ν–‰ μ‹μ μ— ClassCastExceptionμ΄ λ°μƒν•λ‹¤.

μ½”ν‹€λ¦° μ»΄νμΌλ¬λ” μ»΄νμΌ μ‹μ μ— νƒ€μ… μ •λ³΄κ°€ μ£Όμ–΄μ§„ κ²½μ°μ—λ” is κ²€μ‚¬λ¥Ό ν—μ©ν•λ‹¤.

fun printSum(c: Collection<Int>){
	if(c is List<Int>){ -> μ¬λ°”λ¥Έ κ²€μ‚¬
		println(c.sum())
	}
}
```

---

### 9.2.2 μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν• ν•¨μ μ„ μ–Έ

μ½”ν‹€λ¦°μ μ λ„¤λ¦­ νƒ€μ…μ νƒ€μ… μΈμ μ •λ³΄λ” μ‹¤ν–‰μ‹μ μ— μ§€μ›μ§„λ‹¤. λ”°λΌμ„ μ λ„¤λ¦­ ν•¨μκ°€ νΈμ¶λλ„ κ·Έ ν•¨μμ λ³Έλ¬Έμ—μ„λ” νΈμ¶ μ‹ μ“°μΈ νƒ€μ… μΈμλ¥Ό μ• μ μ—†λ‹¤.

```kotlin
fun <T> isA(value: Any) = value is T

println(isA<String>("abc"))
>>> ERROR: Cannot check for instance of erased type: T
```

μ΄λ¬ν• μ μ•½μ„ ν”Όν•κΈ°μ„ν•΄ μΈλΌμΈ ν•¨μλ¥Ό μ‚¬μ©ν•λ‹¤. 

```kotlin
inline fun <reified T> isA(value: Any) = value is T

println(isA<String>("abc"))
>>> true

* reified 
λ°νƒ€μ„μ—μ„ μ λ„¤λ¦­μ¤ νƒ€μ…μ •λ³΄λ¥Ό μ•κΈ°μ„ν•΄ μ‚¬μ©ν•¨

λ§μ•½ inline ν•¨μμ—μ„ reifiedκ°€ μ—†λ‹¤λ©΄ λ…μ‹μ μΌλ΅ νλΌλ―Έν„°λ¥Ό μ „λ‹¬ν•΄μ•Όν•¨
```

μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•λ” μμ  μ¤‘ κ°€μ¥ κ°„λ‹¨ν• filterIsInstanceμ μ‚¬μ©λ²•μ„ μ•μ•„λ³΄μ 

filterIsInstanceλ” μΈμλ΅ λ°›μ€ ν΄λμ¤μ μ›μ† μ¤‘μ—μ„ νƒ€μ… μΈμλ΅ μ§€μ •ν• ν΄λμ¤μ μΈμ¤ν„΄μ¤λ§ λ¨μ•„μ„ λ§λ“  λ¦¬μ¤νΈλ¥Ό λ°ν™ν•λ” ν•¨μμ΄λ‹¤.

```kotlin
val items = listOf("one", 2, "three")
println(items.filterIsInstance<String>())

>>> [one, three]

filterIsInstanceμ νƒ€μ…μΈμλ΅ Stringμ„ μ§€μ •ν•¨μΌλ΅μ¨ λ°ν™λλ” λ¦¬μ¤νΈλ” 
List<String> μ΄λΌλ” κ²ƒμ„ μ• μ μλ‹¤. μ—¬κΈ°μ„λ” νƒ€μ… μΈμλ¥Ό μ‹¤ν–‰ μ‹μ μ— μ• μ μκ³ 
filterIsInstanceλ” κ·Έ νƒ€μ… μΈμλ¥Ό μ΄μ©ν•΄ λ¦¬μ¤νΈμ μ›μ† μ¤‘μ— νƒ€μ… μΈμμ™€ νƒ€μ…μ΄ μΌμΉν•λ”
μ›μ†λ§μ„ μ¶”λ ¤λ‚Ό μ μλ‹¤.

μ½”ν‹€λ¦° ν‘μ¤€ λΌμ΄λΈλ¬λ¦¬μ— μλ” filterIsInstance μ„ μ–Έ
inline fun <reified T> Iterable<*>.filterIsInstance(): List<T>{ (1)
	val destination = mutableListOf<T>()
	for(element in this){
		if(element is T){ (2)
			detination.add(element)
		}
	}
	return destination 
}

(1) : "reified" ν‚¤μ›λ“λ” μ΄ νƒ€μ… νλΌλ―Έν„°κ°€ μ‹¤ν–‰ μ‹μ μ— μ§€μ›μ§€μ§€ μ•μμ„ ν‘μ‹ν•λ‹¤
(2) : κ° μ›μ†κ°€ νƒ€μ… μΈμλ΅ μ§€μ •ν• ν΄λμ¤μ μΈμ¤ν„΄μ¤μΈμ§€ κ²€μ‚¬ν•  μ μλ‹¤

* μΈλΌμΈ ν•¨μμ—μ„λ§ μ‹¤μ²΄ν™”ν• νƒ€μ… μΈμλ¥Ό μ“Έ μ μλ” μ΄μ  :
μ»΄νμΌλ¬κ°€ μΈλΌμΈ ν•¨μμ λ³Έλ¬Έμ„ κµ¬ν„ν• λ°”μ΄νΈμ½”λ“λ¥Ό κ·Έ ν•¨μκ°€ νΈμ¶λλ” λ¨λ“  μ§€μ μ— μ‚½μ…ν•λ‹¤
μ»΄νμΌλ¬λ” μ‹¤μ²΄ν™”ν• νƒ€μ… μΈμλ¥Ό μ‚¬μ©ν•΄ μΈλΌμΈ ν•¨μλ¥Ό νΈμ¶ν•λ” κ° λ¶€λ¶„μ μ •ν™•ν• νƒ€μ…μΈμλ¥Ό
μ• μ μλ‹¤. λ”°λΌμ„ μ»΄νμΌλ¬λ” νƒ€μ… μΈμλ΅ μ“°μΈ κµ¬μ²΄μ μΈ ν΄λμ¤λ¥Ό μ°Έμ΅°ν•λ” λ°”μ΄νΈμ½”λ“λ¥Ό
μƒμ„±ν•΄ μ‚½μ…ν•  μ μλ‹¤.
```

---

### 9.2.3 μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ΅ ν΄λμ¤ μ°Έμ΅°λ¥Ό λ€μ‹ 

java.lang.Class νƒ€μ… μΈμλ¥Ό νλΌλ―Έν„°λ΅ λ°›λ” κ²½μ° μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ¥Ό μμ£Ό μ‚¬μ©ν•λ‹¤.

java.lang.Classλ¥Ό μ‚¬μ©ν•λ” APIμ μλ΅λ” JDKμ ServiceLoaderκ°€ μλ‹¤. ServiceLoaderλ” μ–΄λ–¤ μ¶”μƒ ν΄λμ¤λ‚ μΈν„°νμ΄μ¤λ¥Ό ν‘ν„ν•λ” java.lang.Classλ¥Ό λ°›μ•„μ„ κ·Έ ν΄λμ¤λ‚ μΈμ¤ν„΄μ¤λ¥Ό κµ¬ν„ν• μΈμ¤ν„΄μ¤λ¥Ό λ°ν™ν•λ‹¤.

```kotlin
val serviceImpl = ServiceLoader.load(Service::class.java)

::class.java κµ¬λ¬Έμ€ μ½”ν‹€λ¦° ν΄λμ¤μ— λ€μ‘ν•λ” java.lang.Class μ°Έμ΅°λ¥Ό μ–»λ” λ°©λ²•μ„ λ³΄μ—¬μ¤€λ‹¤.
Service::class.javaλΌλ” μ½”λ“λ” Service.classλΌλ” μλ°” μ½”λ“μ™€ μ™„μ „ν κ°™λ‹¤.

μ΄ μμ λ¥Ό κµ¬μ²΄ν™”ν•λ©΄
val serviceImpl = loadService<Services>()

μ΄μ λ” μ½μ–΄ λ“¤μΌ μ„λΉ„μ¤ ν΄λμ¤λ¥Ό loadService ν•¨μμ νƒ€μ… μΈμλ΅ μ§€μ •ν•λ‹¤.
loadService ν•¨μλ¥Ό μ–΄λ–»κ² μ •μν•  μ μμ„κΉ

inline fun <reified T> loadService(){
	return ServiceLoader.load(T::class.java)
}

λΉ„μ·ν• μλ΅ μ•λ“λ΅μ΄λ“μ—μ„ activityλ¥Ό μ΄λ™ν• λ• μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•  μ μλ‹¤.

inline fun <reified T : Activity> Context.startActivity(){
	val intent = Intent(this, T::class.java)
	startActivity(intent)
}

startActivity<DetailActivity>()
```

---

### 9.2.4 μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°μ μ μ•½

μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ© κ°€λ¥ν• κ²½μ°

- νƒ€μ… κ²€μ‚¬μ™€ μΊμ¤ν… `is` `as` `!is` `!as`
- μ½”ν‹€λ¦° λ¦¬ν”λ ‰μ… API `::class`
- μ½”ν‹€λ¦° νƒ€μ…μ— λ€μ‘ν•λ” java.lang.Classλ¥Ό μ–»κΈ° `::class.java`
- λ‹¤λ¥Έ ν•¨μλ¥Ό νΈμ¶ν•  λ• νƒ€μ… μΈμλ΅ μ‚¬μ©

μ‚¬μ©λ¶κ°€λ¥ν• κ²½μ°

- νƒ€μ… νλΌλ―Έν„° ν΄λμ¤μ μΈμ¤ν„΄μ¤ μƒμ„±
- νƒ€μ… νλΌλ―Έν„° ν΄λμ¤μ λ™λ° κ°μ²΄ λ©”μ„λ“ νΈμ¶
- μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ¥Ό μ”κµ¬ν•λ” ν•¨μλ¥Ό νΈμ¶ν•λ©΄μ„ μ‹¤μ²΄ν™”ν•μ§€ μ•μ€ νƒ€μ… νλΌλ―Έν„°λ΅ λ°›μ€ νƒ€μ…μ„ νƒ€μ…μΈμλ΅ λ„κΈ°κΈ°
- ν΄λμ¤, ν”„λ΅νΌν‹°, μΈλΌμΈ ν•¨μκ°€ μ•„λ‹ ν•¨μμ νƒ€μ… νλΌλ―Έν„°λ¥Ό reifiedλ΅ μ§€μ •ν•κΈ°

---

### 9.3 λ³€μ„± : μ λ„¤λ¦­κ³Ό ν•μ„ νƒ€μ…

λ³€μ„± - `List<String>`μ™€ `List<Any>`μ™€ κ°™μ΄ κΈ°μ € νƒ€μ…μ΄ κ°™κ³  νƒ€μ… μΈμκ°€ λ‹¤λ¥Έ μ—¬λ¬ νƒ€μ…μ΄ μ„λ΅ μ–΄λ–¤ κ΄€κ³„κ°€ μλ”μ§€ μ„¤λ…ν•λ” κ°λ…

μ λ„¤λ¦­ ν΄λμ¤λ‚ ν•¨μλ¥Ό μ§μ ‘ μ •μν•λ ¤λ©΄ λ³€μ„±μ„ κΌ­ μ΄ν•΄ν•΄μ•Ό ν•λ©° λ³€μ„±μ„ μ ν™μ©ν•λ©΄ μ‚¬μ©μ— λ¶νΈν•μ§€ μ•μΌλ©΄μ„ νƒ€μ… μ•μ „μ„±μ„ λ³΄μ¥ν•λ” APIλ¥Ό λ§λ“¤ μ μλ‹¤.

---

### 9.3.1 λ³€μ„±μ΄ μλ” μ΄μ  : μΈμλ¥Ό ν•¨μμ— λ„κΈ°κΈ°

`List<Any>` νƒ€μ…μ νλΌλ―Έν„°λ¥Ό λ°›λ” ν•¨μμ— `List<String>` μΈμλ¥Ό λ„κΈ°λ©΄ μ•μ „ν• κΉ? β†’ μ•μ „ν•λ‹¤ 

μ΄μ λ” `String`ν΄λμ¤λ” `Any`λ¥Ό ν™•μ¥ν•λ―€λ΅ `Any`νƒ€μ… κ°’μ„ νλΌλ―Έν„°λ΅ λ°›λ” ν•¨μμ— `String` κ°’μ„ λ„κ²¨λ„ μ•μ „ν•κΈ° λ•λ¬Έμ΄λ‹¤.

κ·Έλ ‡λ‹¤λ©΄ `Any`μ™€ `String`μ΄ `List` μΈν„°νμ΄μ¤μ νƒ€μ… μΈμλ΅ λ“¤μ–΄κ°€λ” κ²½μ°μ—λ„ μ•μ „ν• κΉ? β†’ μ•„λ‹λ‹¤

```kotlin
fun addAnswer(list: MutableList<Any>){
	list.add(42)
}

μ΄ ν•¨μμ— λ¬Έμμ—΄ λ¦¬μ¤νΈλ¥Ό λ„κ²¨λ³΄μ
val strings = mutableListOf("abc", "bac")
addAnswer(strings)
println(strings.maxBy{ it.length })

>>> ClassCastException: Integer cannot be cast to String

μ•„μ μ»΄νμΌ λμ§€ μ•μ
```

κ²°λ΅  : μ–΄λ–¤ ν•¨μκ°€ λ¦¬μ¤νΈμ μ›μ†λ¥Ό μ¶”κ°€ν•κ±°λ‚ λ³€κ²½ν•λ‹¤λ©΄ νƒ€μ… λ¶μΌμΉκ°€ μƒκΈΈ μ μμ–΄μ„ `List<Any>` λ€μ‹  `List<String>`μ„ λ„κΈΈ μ μ—†λ‹¤. κ·Έλ¬λ‚ **μ›μ† μ¶”κ°€λ‚ λ³€κ²½μ΄ μ—†λ” κ²½μ°**μ—λ” `List<String>`μ„ `List<Any>` λ€μ‹  λ„κ²¨λ„ μ•μ „ν•λ‹¤. λ”°λΌμ„ μ½”ν‹€λ¦°μ—μ„λ” λ¦¬μ¤νΈμ λ³€κ²½ κ°€λ¥μ„±μ— λ”°λΌ μ μ ν• μΈν„°νμ΄μ¤λ¥Ό μ„ νƒν•λ©΄ μ•μ „ν•μ§€ λ»ν• ν•¨μ νΈμ¶μ„ λ§‰μ„ μ μλ‹¤.

---

### 9.3.2 ν΄λμ¤, νƒ€μ…, ν•μ„ νƒ€μ…

νƒ€μ…

- μ λ„¤λ¦­ ν΄λμ¤κ°€ μ•„λ‹ ν΄λμ¤ μ—μ„λ” ν΄λμ¤ μ΄λ¦„μ„ λ°”λ΅ νƒ€μ…μΌλ΅ μ‚¬μ©κ°€λ¥ν•λ° μ΄λ• λ„μ΄ λ  μ μλ” νƒ€μ…λ„ μ‚¬μ©κ°€λ¥ν•¨ `var x : String` , `var x : String?`
- μ λ„¤λ¦­ ν΄λμ¤μ κ²½μ°μ—λ” νƒ€μ… νλΌλ―Έν„°λ¥Ό κµ¬μ²΄μ μΈ νƒ€μ… μΈμλ΅ λ°”κΏ”μ¤μ•Όν•¨ `List<Int>`, `List<String>`β€¦ κ°κ°μ μ λ„¤λ¦­ ν΄λμ¤μ—λ” λ¬΄μν λ§μ€ νƒ€μ…μ„ λ§λ“¤μ–΄ λ‚Ό μ μλ‹¤.

ν•μ„ νƒ€μ… : μ–΄λ–¤ νƒ€μ… Aμ κ°’μ΄ ν•„μ”ν• λ¨λ“  μ¥μ†μ— μ–΄λ–¤ νƒ€μ… Bκ°’μ„ λ„£μ–΄λ„ λ¬Έμ κ°€ μ—†λ‹¤λ©΄ 

Bλ” Aμ ν•μ„ νƒ€μ…μ΄λ‹¤.

 

```kotlin
μλ¥Ό λ“¤μ–΄ Intλ” Numberμ ν•μ„ νƒ€μ…μ΄μ§€λ§ Stringμ ν•μ„ νƒ€μ…μ€ μ•„λ‹λ‹¤.
```

μƒμ„ νƒ€μ…μ€ ν•μ„ νƒ€μ…μ λ°λ€μ΄λ‹¤.

κ·Έλ ‡λ‹¤λ©΄ μ–΄λ–¤ νƒ€μ…μ΄ ν•μ„ νƒ€μ…μΈμ§€ μ™ μ¤‘μ”ν• κΉ? μ΄μ λ” μ»΄νμΌλ¬κ°€ λ³€μ λ€μ…μ΄λ‚, ν•¨μ μΈμ μ „λ‹¬ μ‹ ν•μ„ νƒ€μ… κ²€μ‚¬λ¥Ό λ§¤λ² μν–‰ν•κΈ° λ•λ¬Έμ΄λ‹¤.

```kotlin
fun test(i: Int){
	val n: Number = i (1)
	
	fun f(s: String){...}
	f(i) (2)
}

(1) : Intκ°€ Numberμ ν•μ„ νƒ€μ…μ΄μ–΄μ„ μ»΄νμΌ λλ‹¤.
(2) : Intκ°€ Stringμ ν•μ„ νƒ€μ…μ΄ μ•„λ‹λΌμ„ μ»΄νμΌ λμ§€ μ•λ”λ‹¤.
```

κ°„λ‹¨ν• κ²½μ° ν•μ„ νƒ€μ…μ€ ν•μ„ ν΄λμ¤μ™€ κ·Όλ³Έμ μΌλ΅ κ°™λ‹¤. μλ¥Ό λ“¤λ©΄ Int ν΄λμ¤λ” Number ν΄λμ¤μ ν•μ„ ν΄λμ¤ μ΄λ―€λ΅ Int λ” Numberμ ν•μ„ νƒ€μ…μ΄λ‹¤. Stringμ€ CharSequenceμ ν•μ„ νƒ€μ…μΈ κ²ƒμ²λΌ μ–΄λ–¤ μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•λ” ν΄λμ¤μ νƒ€μ…μ€ κ·Έ μΈν„°νμ΄μ¤ νƒ€μ…μ ν•μ„ νƒ€μ…μ΄λ‹¤.

μ λ„¤λ¦­ νƒ€μ…μ— λ€ν•΄ μ΄μ•ΌκΈ°ν•  λ• νΉν ν•μ„ ν΄λμ¤μ™€ ν•μ„ νƒ€μ…μ μ°¨μ΄κ°€ μ¤‘μ”ν•΄μ§„λ‹¤.

List<String> νƒ€μ…μ κ°’μ„ List<Any>λ¥Ό νλΌλ―Έν„°λ΅ λ°›λ” ν•¨μμ— μ „λ‹¬ν•΄λ„ κ΄μ°®μ€κ°€ `=` 

List<String>μ€ List<Any>μ ν•μ„ νƒ€μ…μΈκ°€

μ λ„¤λ¦­ νƒ€μ…μ„ μΈμ¤ν„΄μ¤ν™”ν•  λ• νƒ€μ… μΈμλ΅ μ„λ΅ λ‹¤λ¥Έ νƒ€μ…μ΄ λ“¤μ–΄κ°€λ©΄ μΈμ¤ν„΄μ¤νƒ€μ… μ‚¬μ΄μ— ν•μ„ νƒ€μ… κ΄€κ³„κ°€ μ„±λ¦½ν•μ§€ μ•μΌλ©΄ κ·Έ μ λ„¤λ¦­ νƒ€μ…μ„ `λ¬΄κ³µλ³€` μ΄λΌκ³  ν•λ‹¤. 

μλ¥Ό λ“¤μ–΄ MutableList Aμ™€ Bκ°€ μ„λ΅ λ‹¤λ¥΄κΈ°λ§ ν•λ©΄ Aλ” Bμ ν•μ„ νƒ€μ…μ΄ μ•„λ‹λ‹¤. 

Aκ°€ Bμ ν•μ„ νƒ€μ…μ΄λ©΄ List<A>λ” List<B>μ ν•μ„ νƒ€μ…μ΄λ‹¤. β†’ `κ³µλ³€μ `

---

### 9.3.3 κ³µλ³€μ„± : ν•μ„ νƒ€μ… κ΄€κ³„λ¥Ό μ μ§€

Producer<T>λ¥Ό μλ΅ κ³µλ³€μ„± ν΄λμ¤λ¥Ό μ„¤λ…ν•λ©΄, Aκ°€ Bμ ν•μ„ νƒ€μ…μΌλ• Producer<A>κ°€

Producer<B>μ ν•μ„νƒ€μ…μ΄λ©΄ Producerλ” `κ³µλ³€μ `μ΄λ‹¤. μ΄λ¥Ό ν•μ„ νƒ€μ… κ΄€κ³„κ°€ μ μ§€λλ‹¤κ³  λ§ν•λ‹¤.

μλ¥Ό λ“¤μ–΄ Catμ΄ Animalμ ν•μ„ νƒ€μ…μ΄κΈ° λ•λ¬Έμ— Producer<Cat>μ€ Producer<Animal>μ ν•μ„ νƒ€μ…μ΄λΌκ³  ν•  μ μλ‹¤.

μ½”ν‹€λ¦°μ—μ„ μ λ„¤λ¦­ ν΄λμ¤κ°€ νƒ€μ… νλΌλ―Έν„°μ— λ€ν•΄ `κ³µλ³€μ `μ„μ„ ν‘μ‹ν•λ ¤λ©΄ νƒ€μ… νλΌλ―Έν„° μ•μ— `out` μ„ λ¶™ν€μ•Ό ν•λ‹¤.

```kotlin
interface Producer<out T>{ -> ν΄λμ¤ Tμ— λ€ν•΄ κ³µλ³€μ μ΄λΌκ³  μ„ μ–Έ
	fun produce(): T
}
```

ν΄λμ¤μ νƒ€μ… νλΌλ―Έν„°λ¥Ό κ³µλ³€μ μΌλ΅ λ§λ“¤λ©΄ ν•¨μ μ •μμ— μ‚¬μ©ν• νλΌλ―Έν„° νƒ€μ…κ³Ό νƒ€μ… μΈμμ νƒ€μ…μ΄ μ •ν™•ν μΌμΉν•μ§€ μ•λ”λΌλ„ κ·Έ ν΄λμ¤μ μΈμ¤ν„΄μ¤λ¥Ό ν•¨μ μΈμλ‚ λ°ν™ κ°’μΌλ΅ μ‚¬μ©ν•  μ μλ‹¤.

```kotlin
open class Animal{
	fun feed(){...}
}

class Herd<T: Animal>{ -> λ¬΄κ³µλ³€μ„±μΌλ΅ μ§€μ •
	val size: Int get() = ...
	operator fun get(i: Int): T {...}
}

fun feedAll(animals: Herd<Animal>){
	for(i in 0 until animals.size){
		animals[i].feed()
	}
}

Herdν΄λμ¤μ νƒ€μ… νλΌλ―Έν„°λ” κ·Έ λ™λ¬Όμ΄ μ–΄λ–¤ λ™λ¬Όλ¬΄λ¦¬μΈμ§€ μ•λ ¤μ¤€λ‹¤.

μ‚¬μ©μ μ½”λ“κ°€ κ³ μ–‘μ΄ λ¬΄λ¦¬λ¥Ό λ§λ“¤μ–΄μ„ κ΄€λ¦¬ν•λ‹¤κ³  ν•μ

class Cat: Animal(){
	fun cleanLitter() {...}
}

fun takeCareOfCats(cats: Herd<Cat>){
	for(i in 0 until cats.size){
		cats[i].cleanLitter()
		//feedAll(cats) -> inferred type is Herd(Cat), but Herd(Animal) was expected μ¤λ¥ λ°μƒ
	}
}
```

μ¤λ¥κ°€ λ‚λ” μ΄μ λ” Herd ν΄λμ¤μ T νƒ€μ… νλΌλ―Έν„°μ— μ•„λ¬΄ λ³€μ„±λ„ μ§€μ •ν•μ§€ μ•μ•κΈ° λ•λ¬Έμ— κ³ μ–‘μ΄λ” λ™λ¬Ό λ¬΄λ¦¬μ ν•μ„ ν΄λμ¤κ°€ μ•„λ‹λΌμ„ μ¤λ¥κ°€ λ‚λ” κ²ƒμ΄λ‹¤.

μ„ μ¤λ¥λ¥Ό ν•΄κ²°ν•κΈ° μ„ν•΄μ„λ” class Herd<out T: Animal>λ΅ Herd ν΄λμ¤λ¥Ό κ³µλ³€μ μΌλ΅ μ§€μ •ν•λ©΄ λλ‹¤.

λ¨λ“  ν΄λμ¤λ¥Ό κ³µλ³€μ μΌλ΅ λ§λ“¤ μλ” μ—†λ‹¤. νƒ€μ… νλΌλ―Έν„°λ¥Ό κ³µλ³€μ μΌλ΅ μ§€μ •ν•λ©΄ ν΄λμ¤ λ‚΄λ¶€μ—μ„ κ·Έ νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•λ” λ°©λ²•μ„ μ ν•ν•λ‹¤. νƒ€μ… μ•μ „μ„±μ„ λ³΄μ¥ν•κΈ° μ„ν•΄ κ³µλ³€μ  νλΌλ―Έν„°λ” ν•­μƒ

out μ„μΉμ— μμ–΄μ•Όν•λ‹¤. μ΄λ” ν΄λμ¤κ°€ T νƒ€μ…μ κ°’μ„ μƒμ„±ν•  μλ” μμ§€λ§ T νƒ€μ…μ κ°’μ„ μ‚¬μ©ν•  μλ” μ—†λ‹¤λ” λ»μ΄λ‹¤.

ν΄λμ¤ λ©¤λ²„λ¥Ό μ„ μ–Έν•  λ• νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•  μ μλ” μ§€μ μ€ λ¨λ‘ `in` κ³Ό `out` μ„μΉλ΅ λ‚λ‰λ‹¤. 

T λΌλ” νƒ€μ… νλΌλ―Έν„°λ¥Ό μ„ μ–Έν•κ³  T λ¥Ό μ‚¬μ©ν•λ” ν•¨μκ°€ λ©¤λ²„λ΅ μλ” ν΄λμ¤λ¥Ό μƒκ°ν•λ©΄ 

T κ°€ ν•¨μμ `λ°ν™ νƒ€μ…`μ— μ“°μΈλ‹¤λ©΄ Tλ” `out` μ„μΉμ— μλ‹¤ β†’ T νƒ€μ…μ κ°’μ„ `μƒμ„±` ν•λ‹¤. 

T κ°€ ν•¨μμ `νλΌλ―Έν„° νƒ€μ…`μ— μ“°μΈλ‹¤λ©΄ Tλ” `in` μ„μΉμ— μλ‹¤ β†’ T νƒ€μ…μ κ°’μ„ `μ‚¬μ©`ν•λ‹¤.

```kotlin
interface TransFormer<T>{
	fun transform(t: T): T
								 (1)  (2)
(1) : in μ„μΉ
(2) : out μ„μΉ
```

ν΄λμ¤ νƒ€μ… νλΌλ―Έν„° T μ•μ— `out` ν‚¤μ›λ“λ¥Ό λ¶™νλ©΄ ν΄λμ¤ μ•μ—μ„ Tλ¥Ό μ‚¬μ©ν•λ” λ©”μ„λ“κ°€ `out` μ„μΉμ—μ„λ§ Tλ¥Ό μ‚¬μ©κ°€λ¥ν•κ² ν•κ³  `in` μ„μΉμ—μ„λ” Tλ¥Ό μ‚¬μ©ν•μ§€ λ»ν•λ„λ΅ ν•λ”λ° μ΄λ” Tλ΅ μΈν•΄ μƒκΈ°λ” νƒ€μ… κ΄€κ³„μ νƒ€μ… μ•μ „μ„±μ„ λ³΄μ¥ν•κΈ° λ•λ¬Έμ΄λ‹¤.

Herdν΄λμ¤λ¥Ό μ‚΄ν΄λ³΄λ©΄ Tλ¥Ό κ³µλ³€μ μΌλ΅ μ‚¬μ©ν•κΈ° λ•λ¬Έμ— `out` μ„μΉμ—λ§ Tλ¥Ό μ‚¬μ©ν•λ”κ²ƒμ„ λ³Ό μ μλ‹¤.

λ”°λΌμ„ Catμ΄ Animalμ ν•μ„ νƒ€μ…μ΄κΈ° λ•λ¬Έμ— Herd<Animal>μ getμ„ νΈμ¶ν•λ” λ¨λ“  μ½”λ“λ” getμ΄ Catμ„ λ°ν™ν•΄λ„ λ¬Έμ μ—†μ΄ μ‘λ™ν•λ‹¤.

Tμ— λ¶™μ€ `out` ν‚¤μ›λ“μ μλ―Έ

- κ³µλ³€μ„± : ν•μ„ νƒ€μ… κ΄€κ³„κ°€ μ μ§€λ¨
- μ‚¬μ© μ ν• : Tλ¥Ό outμ„μΉ(λ°ν™) μ—μ„λ§ μ‚¬μ©ν•  μ μλ‹¤.

List<T> μΈν„°νμ΄μ¤λ¥Ό λ³΄λ©΄ T νƒ€μ…μ μ›μ†λ¥Ό λ°ν™ν•λ” get λ©”μ„λ“λ” μμ§€λ§ T νƒ€μ…μ κ°’μ„ μ¶”κ°€ν•κ±°λ‚ λ¦¬μ¤νΈμ κΈ°μ΅΄κ°’μ„ λ³€κ²½ν•λ” λ©”μ„λ“λ” μ—†λ‹¤. κ·Έλ¬λ―€λ΅ Listλ” Tμ— λ€ν•΄ κ³µλ³€μ μ΄λ‹¤.

```kotlin
interface List<out T>: Collection<T>{
	operator fun get(index: Int): T -> Tκ°€ λ°ν™ μ„μΉμ— μμΌλ―€λ΅ κ³µλ³€μ μ„
}
```

νƒ€μ… νλΌλ―Έν„°λ¥Ό ν•¨μμ νλΌλ―Έν„° νƒ€μ…μ΄λ‚ λ°ν™ νƒ€μ…μ—λ§ μ“Έ μ μλ”κ²ƒμ€ μ•„λ‹λ‹¤. νƒ€μ… νλΌλ―Έν„°λ¥Ό λ‹¤λ¥Έ νƒ€μ…μ νƒ€μ… μΈμλ΅ μ‚¬μ©ν•  μλ„ μλ‹¤.

```kotlin
interface List<out T>: Collection<T>{
	fun subList(fromIndex: Int, toIndex: Int): List<T> -> λ°ν™ μ„μΉμ— μμΌλ―€λ΅ κ³µλ³€μ μ„
}
```
---

### 9.2.4 λ°κ³µλ³€μ„± : λ’¤μ§‘ν ν•μ„ νƒ€μ… κ΄€κ³„

λ°κ³µλ³€μ„±μ€ κ³µλ³€μ„±μ„ κ±°μΈμ— λΉ„μΉ μƒμ΄λΌ ν•  μ μλ‹¤. λ°κ³µλ³€ ν΄λμ¤μ ν•μ„ νƒ€μ… κ΄€κ³„λ” κ³µλ³€ ν΄λμ¤μ κ²½μ°μ™€ λ°λ€μ΄λ‹¤.

```kotlin
interface Comparator<in T>{
	fun compare(e1: T, e2: T): Int {...} // inμλ¦¬μ— Tλ¥Ό μ‚¬μ©
}
```

μ΄ μΈν„°νμ΄μ¤μ λ©”μ„λ“λ” Tλ¥Ό μ†λΉ„ν•κΈ°λ§ ν•λ‹¤. λ”°λΌμ„ T μ•μ—λ” `in` ν‚¤μ›λ“λ¥Ό λ¶™ν€μ•Ό ν•λ‹¤.

Comsumer<T>λ¥Ό μλ΅λ“¤μ–΄ νƒ€μ… Bκ°€ νƒ€μ… Aμ ν•μ„ νƒ€μ…μΈ κ²½μ° Consumer<A>κ°€ Consumer<B>μ ν•μ„ νƒ€μ…μΈ κ΄€κ³„κ°€ μ„±λ¦½ν•λ©΄ μ λ„¤λ¦­ν΄λμ¤ Consumer<T>λ” νƒ€μ…μΈμ Tμ— λ€ν•΄ λ°κ³µλ³€μ μ΄λΌκ³  ν•  μ μλ‹¤. μ—¬κΈ°μ„ Aμ™€ Bμ μ„μΉκ°€ μ„λ΅ λ’¤λ°”λ€λ‹¤λ” μ μ— μ μν•΄μ•Όν•λ‹¤. λ”°λΌμ„ ν•μ„ νƒ€μ… κ΄€κ³„κ°€ λ’¤μ§‘νλ‹¤κ³  λ§ν•λ‹¤.

cat β€”β€”> animal

Producer<cat> β€”β€”> Producer<animal> (κ³µλ³€μ )

Consumer<animal> β€”β€”> Consumer<cat> (λ°κ³µλ³€μ )

| κ³µλ³€μ„± | λ°κ³µλ³€μ„± | λ¬΄κ³µλ³€μ„± |
| --- | --- | --- |
| Producer<out T> | Consumer<in T> | MutableList<T> |
| νƒ€μ… μΈμμ ν•μ„ νƒ€μ… κ΄€κ³„κ°€
μ λ„¤λ¦­ νƒ€μ…μ—μ„λ„ μ μ§€λλ‹¤. | νƒ€μ… μΈμμ ν•μ„ νƒ€μ… κ΄€κ³„κ°€
μ λ„¤λ¦­ νƒ€μ…μ—μ„ λ’¤μ§‘νλ‹¤. | ν•μ„ νƒ€μ… κ΄€κ³„κ°€
μ„±λ¦½ν•μ§€ μ•λ”λ‹¤. |
| Producer<Cat>μ€ 
Producer<Animal>μ 
ν•μ„ νƒ€μ…μ΄λ‹¤. | Consumer<Animal> μ€
Consumer<Cat>μ 
ν•μ„ νƒ€μ…μ΄λ‹¤. |  |
| Tλ¥Ό out μ„μΉμ—μ„λ§ μ‚¬μ©ν•  μ μλ‹¤. | Tλ¥Ό in μ„μΉμ—μ„λ§ μ‚¬μ©ν•  μ μλ‹¤. | Tλ¥Ό μ•„λ¬΄ μ„μΉμ—μ„λ‚ μ‚¬μ©ν•  μ μλ‹¤. |

ν΄λμ¤λ‚ μΈν„°νμ΄μ¤κ°€ μ–΄λ–¤ νƒ€μ… νλΌλ―Έν„°μ— λ€ν•΄μ„λ” κ³µλ³€μ μ΄λ©΄μ„ λ‹¤λ¥Έ νƒ€μ… νλΌλ―Έν„°μ— λ€ν•΄μ„λ” λ°κ³µλ³€μ μΌ μ μλ‹¤. Function μΈν„°νμ΄μ¤κ°€ κ³ μ „μ μΈ μμ΄λ‹¤.

```kotlin
interface Function1<in P, out R>{
	operator fun invoke(p: P) : R
}

Pλ” inμ„μΉμ— μμΌλ―€λ΅ ν•μ„ νƒ€μ…κ΄€κ³„μ™€ λ°λ€λκ³ (λ°κ³µλ³€μ )
Rλ” outμ„μΉμ— μμΌλ―€λ΅ ν•μ„ νƒ€μ…κ΄€κ³„μ™€ λ™μΌν•λ‹¤(κ³µλ³€μ )

κ·Έλ¬λ―€λ΅ μ•„λμ™€ κ°™μ΄ μ‚¬μ©ν•  μ μλ‹¤.
fun enumerateCats(f: (Cat) -> Number){...}
fun Animal.getindex(): Int = ...

enumerateCats(Animal::getIndex)

 Animal         ------->  Cat 
(Animal) -> Int -------> (Cat) -> Number (λ°κ³µλ³€)
 Int            ------->  Number (κ³µλ³€μ )
```

---

### 9.3.5 μ‚¬μ© μ§€μ  λ³€μ„± : νƒ€μ…μ΄ μ–ΈκΈ‰λλ” μ§€μ μ—μ„ λ³€μ„± μ§€μ •

ν΄λμ¤λ¥Ό μ„ μ–Έν•λ©΄μ„ λ³€μ„±μ„ μ§€μ •ν•λ©΄ κ·Έ ν΄λμ¤λ¥Ό μ‚¬μ©ν•λ” λ¨λ“  μ¥μ†μ— λ³€μ„± μ§€μ •μκ°€ μν–¥μ„ λΌμΉλ―€λ΅ νΈλ¦¬ν•λ‹¤ μ΄λ° λ°©μ‹μ„ `μ„ μ–Έ μ§€μ  λ³€μ„±` μ΄λΌκ³  λ¶€λ¥Έλ‹¤.

μλ°”μ μ™€μΌλ“ μΉ΄λ“ νƒ€μ…μ— μµμ™ν•λ‹¤λ©΄ μλ°”λ” λ³€μ„±μ„ λ‹¤λ¥Έ λ°©μ‹μΌλ΅ μ‚¬μ©ν•λ‹¤λ” κ²ƒμ„ μ• μ μλ‹¤.

μλ°”μ—μ„λ” νƒ€μ… νλΌλ―Έν„°κ°€ μλ” νƒ€μ…μ„ μ‚¬μ©ν•  λ•λ§λ‹¤ ν•΄λ‹Ή νƒ€μ… νλΌλ―Έν„°λ¥Ό ν•μ„ νƒ€μ…μ΄λ‚ μƒμ„ νƒ€μ… μ¤‘ μ–΄λ–¤ νƒ€μ…μΌλ΅ λ€μΉν•  μ μλ”μ§€ λ…μ‹ν•΄μ•Ό ν•λ‹¤. μ΄λ° λ°©μ‹μ„ `μ‚¬μ© μ§€μ  λ³€μ„±`μ΄λΌ λ¶€λ¥Έλ‹¤.

μ½”ν‹€λ¦°λ„ μ‚¬μ© μ§€μ  λ³€μ„±μ„ μ§€μ›ν•λ‹¤. ν΄λμ¤ μ•μ—μ„ μ–΄λ–¤ νƒ€μ… νλΌλ―Έν„°κ°€ κ³µλ³€μ μ΄κ±°λ‚ λ°κ³µλ³€μ μΈμ§€ μ„ μ–Έν•  μ μ—†λ” κ²½μ°μ—λ„ νΉμ • νƒ€μ… νλΌλ―Έν„°κ°€ λ‚νƒ€λ‚λ” μ§€μ μ—μ„ λ³€μ„±μ„ μ •ν•  μ μλ‹¤.

MutableListμ™€ κ°™μ€ μƒλ‹Ήμμ μΈν„°νμ΄μ¤λ” νƒ€μ… νλΌλ―Έν„°λ΅ μ§€μ •λ νƒ€μ…μ„ μ†λΉ„ν•λ” λ™μ‹μ— μƒμ‚°ν•  μ μκΈ° λ•λ¬Έμ— κ³µλ³€μ μ΄μ§€λ„ λ°κ³µλ³€μ μ΄μ§€λ„ μ•λ‹¤.

```kotlin
fun <T> copyData(source: MutableList<T>, destination: MutableList<T){
	for(item in source){
		destination.add(item)
	}
}
```

μ„ ν•¨μλ” λ‘ μ»¬λ ‰μ… λ¨λ‘ λ¬΄κ³µλ³€νƒ€μ…μ΄λ©° μ›λ³Έμ»¬λ ‰μ…μ—μ„λ” λ°μ΄ν„°λ¥Ό μ½κΈ°λ§ν•κ³  λ€μƒ μ»¬λ ‰μ…μ—μ„  μ“°κΈ°λ§ ν•λ‹¤. μ΄κ²½μ° λ‘ μ»¬λ ‰μ…μ μ›μ† νƒ€μ…μ΄ μΌμΉν•  ν•„μ”κ°€ μ—†λ‹¤. λ§μ•½ λ‹¤λ¥Έ λ¦¬μ¤νΈ νƒ€μ…μ—μ„λ„ μ‘λ™ν•κ² λ§λ“λ ¤λ©΄ λ‘ λ²μ§Έ μ λ„¤λ¦­ νƒ€μ…νλΌλ―Έν„°λ¥Ό λ„μ…ν•  μ μλ‹¤.

```kotlin
fun<T: R, R> copyData(source: MutableList<T>, destination: MutableList<R>){
	for(item in source){
		detination.add(item)
	}
}

val ints = mutableListOf(1, 2, 3)
val anys = mutableListOf<Any>()

copyData(ints, anys)
```

λ‘ νƒ€μ… νλΌλ―Έν„°λ” μ›λ³Έκ³Ό λ€μƒ λ¦¬μ¤νΈμ μ›μ† νƒ€μ…μ„ ν‘ν„ν•λ‹¤. ν• λ¦¬μ¤νΈμ—μ„ λ‹¤λ¥Έ λ¦¬μ¤νΈλ΅ μ›μ†λ¥Ό λ³µμ‚¬ν•  μ μμΌλ ¤λ©΄ μ›λ³Έ μ›μ† νƒ€μ…μ€ λ€μƒ λ¦¬μ¤νΈ νƒ€μ…μ ν•μ„ νƒ€μ…μ΄μ–΄μ•Ό ν•λ‹¤. `Ints` μ™€ `anys`

νƒ€μ… μ„ μ–Έμ—μ„ νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•λ” μ„μΉλΌλ©΄ μ–΄λ””μ—λ‚ λ³€μ„± λ³€κ²½μλ¥Ό λ¶™ν μ μλ‹¤. 

μ΄λ• `νƒ€μ…ν”„λ΅μ μ…`(μ μ•½μ„ κ°€ν•)μ΄ μΌμ–΄λ‚λ‹¤. μ¦‰ Sourceλ¥Ό μΌλ°μ μΈ MutableListκ°€ μ•„λ‹λΌ MutableList λ¥Ό μ μ•½μ„ κ°€ν• νƒ€μ…μΌλ΅ λ§λ“ λ‹¤.

```kotlin
out ν”„λ΅μ μ… νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©

fun <T> copyData(source: MutableList<out T>, destination: MutableList<T>){
	for(itme in source){
		destination.add(item)
	}
}

in ν”„λ΅μ μ… νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©

fun <T> copyData(source: MutableList<T>, destination: MutableList<in T>){
	for(item in source){
		destination.add(item)
	}
}
```

<aside>
π’΅ μ½”ν‹€λ¦°μ μ‚¬μ© μ§€μ  λ³€μ„± μ„ μ–Έμ€ μλ°”μ μ™€μΌλ“ μΉ΄λ“μ™€ κ°™λ‹¤.
μ½”ν‹€λ¦°μ `MutableList<out T>` λ” μλ°” `MutableList<? extends T>` μ™€ κ°™κ³ 
μ½”ν‹€λ¦°μ `MutableList<in T>` λ” μλ°” `MutableList<? super T>` μ™€ κ°™λ‹¤.

</aside>

---

### 9.3.6 μ¤νƒ€ ν”„λ΅μ μ… : νƒ€μ… μΈμ λ€μ‹  * μ‚¬μ©

MutableList<*> μ€ MutableList<Any?>μ™€ κ°™μ§€ μ•λ‹¤. Any? λ” λ¨λ“  νƒ€μ…μ μ›μ†λ¥Ό λ‹΄μ„ μ μλ‹¤λ” κ²ƒμ΄κ³  * μ€ μ–΄λ–¤ μ •ν•΄μ§„ κµ¬μ²΄μ μΈ νƒ€μ…μ μ›μ†λ§μ„ λ‹΄λ” λ¦¬μ¤νΈμ§€λ§ κ·Έ μ›μ†μ νƒ€μ…μ„ μ •ν™•ν λ¨λ¥Έλ‹¤λ” μ‚¬μ‹¤μ„ ν‘ν„ν•λ‹¤. μ—¬κΈ°μ„ μ›μ†μ νƒ€μ…μ„ λ¨λ¥Έλ‹¤κ³ ν•΄μ„ λ¨λ“  νƒ€μ…μ μ›μ†λ¥Ό λ‹¤ λ‹΄μ•„λ„ λλ‹¤λ” λ»μ€ μ•„λ‹λ‹¤.

```kotlin
val list: MutableList<Any?> = mutableListOf('a', 1, 'qwe')
val chars = mutableListOf('a','b','c')
val unknownElements: MutableList<*> = if(Random().nextBoolean()) list else chars

unknownElements.add(42) (1)
>>> ERROR: Out-projected type 'MutableList<*>' prohibits the use of 'fun add(element: E)
: Boolean'

print(unknownElements.first()) (2)
>>> a

(1) : MutableList<*>λ” MutableList<out Any?> μ²λΌ λ™μ‘ν•λ―€λ΅ μ–΄λ–¤ λ¦¬μ¤νΈμ—μ„ μ›μ† νƒ€μ…μ„
λ°λΌλ„ μ•μ „ν•κ² κΊΌλ‚΄μ¬ μ μμ§€λ§(2) νƒ€μ…μ„ λ¨λ¥΄λ” λ¦¬μ¤νΈμ— μ›μ†λ¥Ό λ„£μ„ μλ” μ—†λ‹¤.
```

νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‹κ·Έλ‹μ²μ—μ„ μ „ν€ μ–ΈκΈ‰ν•μ§€ μ•κ±°λ‚ λ°μ΄ν„°λ¥Ό μ½κΈ°λ” ν•μ§€λ§ κ·Έ νƒ€μ…μ—λ” κ΄€μ‹¬μ΄ μ—†λ” κ²½μ°μ™€ κ°™μ΄ νƒ€μ… μΈμ μ •λ³΄κ°€ μ¤‘μ”ν•μ§€ μ•μ„ λ•λ„ `μ¤νƒ€ ν”„λ΅μ μ…` κµ¬λ¬Έμ„ μ‚¬μ©ν•  μ μλ‹¤.

```kotlin
fun printFirst(list: List<*>){
	if(list.isNotEmpty()){
		println(list.first())
	}
}
```
